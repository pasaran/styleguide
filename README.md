Styleguide для JavaScript'а
===========================

Основное положение: экономить байты в коде должен обфускатор, а код должен быть максимально читаемым и понятным.
В общем не жалеем пробелов и пустых строк.

Общие положения
---------------

  * Кодировка файлов -- utf-8;
  * Переводы строк -- unix style;
  * Индент -- 4 пробела;
  * Не забываем удалять "висящие" пробелы, т.е. те, после которых нет непробельных символов.

Блоки кода `{...}`
------------------

Открывающая `{` расположена на той же строке, что и оператор, к которому она относится.

**Неправильно:**
```js
if (expr)
{
    ...
}
```

Закрывающая `}` выровнена по открывающему оператору (внутренняя по `while`, внешняя по `if` в данном случае):

```js
if (expr) {
    while (i < 10) {
        ...
    }
}
```

Чисто в теории, мы для красоты можем захотеть сделать просто блок кода,
не являющийся телом функции или оператора. В этом случае `{` и `}` выровнены одинаково:

```js
var a = 1;
{
    do_something();
}
```

Перед открывающей `{` всегда ставится пробел, за вычетом предыдущего случая.


Оператор `if`
-------------

Между `if` и `(` всегда пробел, перед `{` тоже пробел:

```js
if (expr) {
    ...
}
```

`else` на той же строке, что и `}` первого блока, перед `else` -- пробел, перед `{` -- пробел:

```js
if (expr) {
    ...
} else {
    ...
}

if (expr1) {
    ...
} else if (expr2) {
    ...
} else {
    ...
}
```


Оператор `while`
----------------

Между `while` и `(` -- пробел, перед `{` -- пробел.

```js
while (expr) {
    ...
}
```

Оператор `for`
--------------

Между `for` и `(` -- пробел, перед `{` -- пробел.
Если переменные `i` и `l` не используются нигде, кроме тела цикла, то определяем их внутри:

```js
for (var i = 0, l = a.length; i < l; i++) {
    ...
}
```

Если же переменные цикла используются и за пределами блока, то определяем их отдельно:

```js
var i, l;

for (i = 0, l = a.length; i < l; i++) {
    ...
}

for (i = 0, l = b.length; i < l; i++) {
    ...
}
```


Вызов функции
-------------

Между именем функции и `(` нет пробела.

```js
var a = f(1, 2) + g();
```


Определение функции
-------------------

Между `function` и именем функции -- пробел (очевидно), между именем функции и `(` -- нет пробела:

```js
function name() {
    ...
}

function name(arg) {
    ...
}
```

В случае анонимной функции, ключевое слово `function` в каком-то смысле выполняет роль имени,
поэтому между `function` и `(` нет пробела:

```js
function() {
    ...
}
```

Между `function` и `(` пробела по-прежнему нет, перед запятой никогда нет пробела, после -- всегда есть.

```js
function(arg1, arg2) {
    ...
}
```


Выражения
---------

Все бинарные операции (присваивания, сравнения, арифметические и т.д.) всегда отбиваются пробелами с двух сторон:

```js
var a = 1;

if (a == b || a > 1) {
    ...
}
```

Все унарные операции (унарный минус, инкременты, и т.д.) никогда не отбиваются пробелами:

```js
if (!a && -a < 3 || ~a) {
    i++;
}
```

Скобки добавляем, если выражение сложное и приоритеты не читаются сразу. Но без фанатизма:

```js
var a = b || c && d > 0 || b == 0;
var a = (b || c) && (d > 0 || b) == 0;
var a = b || (c && (d > 0)) || (b == 0);
```

При сравнении выражения с константой, слева -- выражение, справа -- константа.

```js
if (1 == a && true !== f(a)) { // Плохо
    ...
}

if (a == 1 && f(a) !== true) { // Хорошо
    ...
}
```


`==` vs. `===`
--------------

Всегда используем `===`:

```js
if (typeof obj === "string") {
    ...
}
```

За исключением одного случая, когда нужно проверить, не является ли значение `null` или `undefined`.

```js
if (value == null) { // Или value == undefined.
    ...
}
```


Определение переменных
----------------------

Каждая переменная заслуживает своего личного `var`:

```js
var i = 0;
var result = {};
var list = [];
```

Никогда-никогда нельзя писать так. **Неправильно:**

```js
var i = 0,
    result = {},
    list = [];
```

Единственное исключение: набор однородных и связанных
(т.е. эти переменные для одного и того же и не могут использоваться порознь)
переменных, без инициализации. Например:

```js
var i, j, k;
for (i = 0; i < 10; i++) {
    for (j = 0; j < 10; j++) {
        for (k = 0; k < 10; k++) {
            ...
```

Имена для переменных, функций, классов и т.д.
---------------------------------------------

  * С большой буквы -- названия классов и миксинов, с маленькой -- все остальное;

  * Используем `camelCase`, а не `under_score_style`.
    Редкие исключения: переменные с суффиксом типа `_id`:

        var model_id = ...; // modelId плохо читается.

    **Подумать:** не стоит ли в названиях переменных использовать `under_score_style`?

  * "Приватные" переменные: `_privateVariable`.

Тернарный оператор
------------------

Условие в скобках, вокруг `?` и `:` -- пробелы:

```js
var x = (a > 0) ? 1 : 0;
```

`if` vs. тернарный оператор, `&&`, `||`
---------------------------------------

Да, JavaScript позволяет использовать тернарный оператор в качестве замены `if`:

```js
(a > 0) ? f() : g();

(a > 0) && f();

(a > 0) || g();
```

Но это **дурной тон**. Никогда-никогда так не делаем.

Не ленимся, не экономим байты и используем `if`:

```js
if (a > 0) {
    f();
} else {
    g();
}

if (a > 0) {
    f();
}

if (!(a > 0)) {
    g();
}
```

Правило очень простое.
Если блок не возвращает значение или же мы это значение игнорируем, то всегда используется `if`.
Тернарный оператор, `&&` и `||` могут использоваться как часть выражения, возвращаюшего значение:

```js
a = b && c;
b = (a > 0) || true;
c = (a > 0) ? 2 : f();
```

Комментарии
-----------

Желательно использовать инлайновые комментарии, а не блочные.
Причина простая: код, в котором есть блочные комментарии,
невозможно легко и просто закомментировать.
А инлайновые комментарии этому не мешают.

После `//` добавляем **два** пробела.
Причина: комментарии в этом случае выравниваются "по сетке".
В комментариях используем `markdown`.

```js
//  Комментарий, относящийся к блоку кода.
//
function a() {
    //  Поясняем конкретную строку.
    if (x > 0) {
        ...
    }

    //  Коммент про блок кода.
    //  Многострочный и многословный.
    //
    //  Считаем, что комментарии написаны с использованием markdown:
    //
    //      for (var i = 0; i < 10; i++) {
    //          ...
    //      }
    //
    for (var i = 0; i < 10; i++) {
        ...
    }
}
```

Блочные комментарии всегда располагаем на отдельной строке.

**Плохо**
```js

/* function a() {
    ...
} */
```

Хорошо:

```js
/*
function a() {
    ...
}
*/
```

Кавычки
-------

Всегда используем одинарные кавычки:

```js
// Во-первых, удобнее набирать -- не нужно нажимать шифт.
var msg = 'Hello, World!';

// Во-вторых, в html'ных фрагментах можно использовать двойные кавычки и не эскейпить их.
var html = '<div class="hello">Hello, World</div>';
```

